## 텍스트 표현

컴퓨터는 비트를 사용해 수, 문자, 기호 등을 표현한다.
텍스트를 표현하는 방법에도 여러가지 방법이 있었고, 그 중 현재에는 **정보 교환을 위한 미국 표준 코드**(ASCII, American Standard Code for information Interchange)을 주로 사용하고 있다.

<br />

### 아스키 코드 (ASCII Code, 1963)

영문 알파벳을 사용하는 대표적인 문자 인코딩.
키보드에 있는 모든 기호에 대해 **7비트** 수 값을 할당했다.
대부분의 문자 인코딩이 아스키에 기초를 두고 있다.

![아스키코드표](https://cdn.discordapp.com/attachments/879215554379018243/972183959242936340/unknown.png)

- 33개의 출력 불가능한 제어문자
- 공백을 비롯한 95개의 출력 가능한 문자
  총 128개로 이루어져 있다.

<br />

**제어 문자표**
제어할 때 쓰는 코드이다.

![아스키 제어문자](https://cdn.discordapp.com/attachments/879215554379018243/972185735086108672/unknown.png)

이 중 상당수는 통신 제어를 위한 문자이다.
ex) ACK(수신확인): 메시지를 받았음, NAK(반수신확인): 메시지를 받지 못함

### 다른표준의 진화

초기 컴퓨터는 대부분 미국산 아니면 영국산이었다. 그리고 아스키 코드는 영어를 표현하는데 필요한 모든 문자를 포함하고 있어 표준 역할을 오래 해왔다.

그러나 컴퓨터가 널리 쓰이면서 그 밖에 언어를 지원해야 할 필요가 늘어났다.

- **유럽**: 국제 표준화 기구 (ISO)에서 ISO-646, ISO-8859 도입
  - 아스키를 확장해 유럽 언어에 필요한 액센트 기호, 발음 구별 기호를 추가. (128개 => 256개의 문자를 표현)
- **일본**: JISX 0201 - 일본 문자 표현
- **한국**: KS C 5601 등 표준이 생김

이렇게 다양한 표준이 생긴 이유는 비트가 지금보다 더 비싼 시절에 표준이 만들어졌기 때문이다. 문자를 7비트나 8비트에 욱여넣었다.

그 후 비트 가격이 떨어면서 **유니코드** 라는 새로운 표준이 만들어졌다.

## <br />

---

### 유니코드

- **유니코드 1.0**

  - 문자에 16비트 코드 부여
  - 65,546개의 문자를 포함하는 규격
  - 16비트로 모든 문자를 표현할 수 있을 것이라 생각했지만, 포함되지 않은 문자들이 있어 1년만에 개정되었다.

- **유니코드 2.0**
  - 총 1,114,112 개의 문자를 표현할 수 있다. 거의 지구상의 모든 문자를 표현하며, 아직 표현되지 않은 언어를 위해 예비공간을 확보할 수 있는 정도의 규격이다.
  - 현재 세계적으로 사용되는 유니코드는 유니코드 2.0의 체계 아래에서 업데이트 되고 있다.
    <br />

#### 평면(Plane)

유니코드는 백만이 넘는 범위를 가지므로, 적당한 범위로 나뉘어서 관리를 한다. 이 **범위**를 **평면**이라고 부른다. 즉, 코드포인트를 그룹별로 묶은 범위이다.

| 평면           | 범위(16진법)       | 설명                                                                 |
| -------------- | ------------------ | -------------------------------------------------------------------- |
| 0평면(BMP)     | 0x00000 ~ 0x0FFFF  | 기본 다국어 평면. 현대 언어 대부분의 문자 (유니코드 1.0 시점의 범위) |
| 1평면(SMP)     | 0x10000 ~ 0x1FFFF  | 보조 다국어 평면. 고어 및 여러 기호문자와 이모티콘                   |
| 2평면(SIP)     | 0x20000 ~ 0x2FFFF  | 보조 상형문자 평면. 1평면에 포함되지 않은 한중일 통합 한자           |
| 3~13평면       | 0x30000 ~ 0xDFFFF  | 할당되지 않음(예비)                                                  |
| 14평면(SSP)    | 0xE0000 ~ 0xEFFFF  | 보조 특수 목적 평면. 태그 및 제어용 문자                             |
| 15~16평면(PUA) | 0xF0000 ~ 0x10FFFF | 사용자 정의 영역                                                     |

한글은 대부분 BMP에 들어가있다.
유니코드 2.0에서 정의된 1~16평면을 '보충 평면', '아스트랄플레인'이라고 부르기도 한다.

<br >

#### 코드포인트

유니코드는 문자 하나 당 고유한 숫자값을 부여하였다. 이 숫자값을 코드포인트라고 한다.

ex) "a안b녕"

- 각 글자에 대한 코드 포인트는 아래와 같다.

  - a: 0x61
  - 안: 0xC548
  - b: 0x62
  - 녕: 0xB155

<br >

이를 **바이트 단위**로 적어보면 61 C5 48 62 B1 55 이다. (16진법 두자리 숫자는 1바이트)
그러나 이렇게 차례대로 적은 바이트를 보고 문자로 바꾸는 것은 불가능하다.
61 | C5 48 | 62 | B1 55 =>이런 식으로 구분해야 하는데
61 C5 | 48 62 | B1 55 =>이런 식으로 볼 수도 있다. ( ‘懅 ዾ녕’ 이 된다.. )

<br >

#### **코드 유닛**

위와 같이 바이트를 어떻게 잘라서 하나의 코드 포인트로 볼 것인지에 대한 방법에 대해 생각해보자 .

- 1 바이트 단위로 코드 포인트를 인식하면
  - 61 | C5 | 48 | 62 | B1 | 55 => 6글자로 해석 => ‘aÅ0b±7’
- 2 바이트 단위로 코드 포인트를 인식하면 => ‘懅 ዾ녕’

이렇게 바이트를 어떻게 나누냐에 따라 결과가 완전히 달라진다. => 바이트를 나누는 단위: **코드 유닛**
위의 'a안b녕'을 코드 유닛 2바이트로 해서 바르게 표현하면 다음과 같이 된다.

- a: 00 61
- 안: C5 48
- b: 00 62
- 녕: B1 55

  여기서 a, b는 1바이트만 필요한데도 2바이트 코드유닛에 맞추기 위해 00을 삽입했다. 이를 **패딩**이라 부른다.
  코드 유닛의 크기가 클수록 패딩 크기도 커져서 메모리 사용량이 많아진다.

<br />

---

#### 유니코드 변환 형식

아스키 코드는 문자에 7비트를 부여했지만, 컴퓨터는 7비트값을 처리하도록 설계되지 않아 8비트를 사용해 아스키 문자를 저장한다.

또, 유니코드는 문자에 16비트 코드를 부여했지만, 굳이 16비트를 사용해 낭비할만큼 비트가 저렴하지 않아, 한 문자를 8비트로 표현한다. 이렇게 다른 비트 패턴으로 표현하기 위해 사용하는 비트 패턴을 **인코딩**(encoding)이라고 한다.

<br >

#### 유니코드 변환 형식 8비트 (UTF-8, Unicode Transformation Format-8 bit)

- 하위 호환성과 효율성이 좋아 가장 널리 쓰이고 있는 인코딩 방법이다.
- 1~4bytes의 가변길이 인코딩
- 모든 아스키 문자를 8비트로 표현한다. => 7비트를 8비트로 변환하기 때문에 추가 공간이 필요하지 않음
- 아스키 문자가 아닌 경우, 아스키를 받아서 처리하는 프로그램이 깨지지 않는 방법으로 문자를 인코딩 함

<br />

- UTF-8은 문자를 **8비트 덩어리(옥텟)의 시퀀스로 인코딩**한다.
  ![가변 인코딩 방식](https://miro.medium.com/max/1400/1*A6GcpKbbG-u6ps66f_rEjg.png)(출처: 위키피디아)
  <br />
  글자마다 바이트 길이가 다르므로 가변을 구분하기 위해 첫 바이트(MSB)에 길이를 표현해주었다. 1바이트는 0, 2바이트는 110, 3바이트는 1110으로 시작한다. 나머지 바이트는 10으로 시작한다.
  MSB 쪽의 비트 패턴이 겹치지 않아 덩어리의 맨 앞을 식별하기 쉽다.=> 프로그램이 문자 경계를 찾아야 하는 경우 유용하다.

#### 그 외 인코딩 종류

**UTF-16**

- 2~4 바이트를 코드 유닛으로 사용.
- 자바스크립트 경우 인터넷에서 파일을 받을 때는 UTF-8로 받지만, 그 받은 파일을 해석하여 메모리에 적재하는 시점에는 UTF-16으로 처리한다.
- 그 외에도 자바, 윈도우 응용프로그램 작동 시 사용한다.

**UTF-32**

- 4바이트를 코드 유닛으로 사용.
- 유니코드의 코드 포인트 최대 크기는 4바이트이므로, UTF-32를 쓰는 경우 인코딩, 디코딩 과정이 필요없이 코드포인트 그대로 코드 유닛에 표현할 수 있다.
- 많은 패딩이 발생해 용량이 불어나서, 효율적인 메모리 사용을 위해 UTF-8과 UTF-16을 사용하는 것이다.
- 유닉스 시스템의 일부나 인코딩 이슈를 피하고 싶을 때 사용한다.

---

참고

- 아스키코드? 유니코드가 뭐지? https://dodonam.tistory.com/201
- https://developer.mozilla.org/ko/docs/Glossary/Unicode
- 제어문자 사용하기 https://dojang.io/mod/page/view.php?id=63
- 유니코드 #1 https://www.bsidesoft.com/3435
- 유니코드 #2 https://www.bsidesoft.com/3496
- 유니코드 #3 https://www.bsidesoft.com/3526
- https://miaow-miaow.tistory.com/37
